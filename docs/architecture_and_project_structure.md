# Архитектура

### Presentation

Логика в presentation слое может быть Бизнес логикой(Elementary Model) или UI логикой(Widget Model).

- Бизнес логика -  это реализация необходимого функционала для данных в приложении. Например, добавление товара в корзину, когда пользователь нажимает на кнопку.
- UI логика - это реализация того как отобразить то или иное состояние на экране. Например, логика навигации, когда пользователь нажимает на кнопку.

### Repository

Репозиторий создан как абстракция данных из хранилища. Это позволяет `ElementaryModel` независеть от конкретных данных.
Вам необходимо взаимодействовать с репозиторием из интерфейса `ElementaryModel`.

### Управление зависимостями

Необходимо соблюдать одно правило: сущности на одном слое должны зависеть только от сущностей на соседних слоях, но не от сущностей на том же слое. То есть один репозиторий не должен зависеть от другого репозитория.

Также необходимо соблюдать направление, то есть репозиторий может зависеть от источника данных, но не наоборот.

# Обработка ошибок

Для обработки ошибок используется класс `Result`. Он возвращает либо результат, либо соответствующую ошибку.

Возвращаемый тип для всех методов репозитория это `RequestOperation<T>`, - typedef для асинхронного `Result`.
Внутри метода, если все успешно, то возвращается `Result.ok(data)`, а если обнаружены ошибки, то возвращается `Result.failed(failure)`. Результат вызова метода репозитория обрабатывается через switch в `ElementaryModel`.

# Структура проекта

> - директории, выделенные курсивом, не обязательны.
> - в {таких скобках} паттерн для наименоваия файла/директории.

## assets

Содержит следующие ассеты:

- docs - ассеты для документации, которые будут использоваться в /docs директории.
- fonts - шрифты для проекта.
- icons - SVG иконки.
- images - PNG, JPG и другие картинки.
- launcher_icon - иконки приложения.
- splash - изображение для нативного splash экрана.

## docs

Содержит документацию проекта.

### features

Содержит документацию для специфичных feature's.

## lib

Данная директория содержит весь код проекта и состоит из следующих директорий:

- api - слой данных и взаимодействий с Rest API.
- assets - строковая переадресация для необходимых ассетов, тем, цветов и строк.
- common - файлы, не связанные с проектом и которые могут использоваться в других проектах. Например, утилиты или обобщенные виджеты(виджеты массового использования?).
- config - конфигурация проекта.
- core - содержит основные архитектурные блоки для каждой feature в проекте.
- features - features, которые используются в проекте. "shared" - содержит код, который нельзя отнести к какой-то одной feature и используется сразу в нескольких.
- l10n - файлы локализации.
- persistence - слой данных и взаимодействий с базой данных.
- util - необходимые утилиты для всего проекта.

### features

Структура для features:

- di - реализация Dependency Injection.
- data - слой данных из Clean Architecture, состоит из:
  - converters - классы-мапперы для перевода данных из DTO(Data Transfer Object) в сущности и наоборот. Наследуются от стандартного класса `Converter`.
  - repositories - репозитории для feature.
- domain - domain-слой из Clean Architecture, состоит из:
  - entities - модели данных.
  - repositories - интерфейсы для репозиториев для feature.
- presentation - presentation-слой из Clean Architecture, состоит из:
  - {feature_name}_screen.dart - Widget, аналогично View из MVVM. Наследуется от `ElementaryWidget`.
  - {feature_name}_wm.dart - WidgetModel, аналогично ViewModel из MVVM. Наследуется от `WidgetModel`.
  - {feature_name}_model.dart - Model, аналогично Model из MVVM. Наследуется от `ElementaryModel`.
  - widgets - содержит виджеты.
  - utils - содержит необходимые утилиты.

## scripts

Содержит сценарии, которые используются в проекте. Описание скриптов можно прочитать в [README.md](../README.md).

## test

Тесты для приложения.

## gen

Содержит сценарии и инструменты для авто-генерации кода.